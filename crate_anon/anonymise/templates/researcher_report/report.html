<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>{{ title }}</title>
        <style>{{ css|safe }}</style>
    </head>
    <body>
        <h1>{{ db_name }}</h1>
        <p>
            Report generated at:
            <span class="result">{{ now }}</span>
        </p>
        <p>
            Database:
            <span class="result">{{ db_name }}</span>
        </p>
        {% if url %}
            <p>
                URL (sanitised):
                <span class="result">{{ url }}</span>
            </p>
        {% endif %}
        <p>
            Database engine:
            <span class="result">{{ db_engine }}</span>
        </p>
        <p>
            Number of tables:
            <span class="result">{{ n_tables }}</span>
        </p>
        <ul>
            {% for table_name in table_names %}
                <li><span class="result">{{ table_name }}</span></li>
            {% endfor %}
        </ul>

        <p class="info">
            Key:
        </p>
        <ul class="info">
            <li>
                CRATE (Clinical Records Anonymisation and Text Extraction):
                software for creating research databases.
                See <a href="https://www.pubmed.gov/28441940">https://www.pubmed.gov/28441940</a>
                or <a href="https://crateanon.readthedocs.io/">https://crateanon.readthedocs.io/</a>.
            </li>
            <li>
                DB: database.
            </li>
            <li>
                DD: data dictionary, used by CRATE to build a de-identified
                research database from source data.
            </li>
            <li>
                FK: foreign key, a cross-reference to a PK in another table.
            </li>
            <li>
                MRID: master patient research identifier.
            </li>
            <li>
                NLP: natural language processing, in which computers read free
                text to extract structured data.
            </li>
            <li>
                NOT NULL: a column that is not allowed to contain NULL values.
            </li>
            <li>
                NULL: a missing or blank value.
            </li>
            <li>
                PK: primary key, the main column (or sometimes columns)
                defining and indexing a table.
            </li>
            <li>
                SQL: Structured Query Language, the standard language for
                defining and querying databases.
            </li>
            <li>
                RID: patient research identifier.
            </li>
            <li>
                TRID: transient patient research identifier; this can be useful
                for fast cross-referencing within SQL queries, but will change
                when the database is rebuilt.
            </li>
            <li>
                URL: uniform resource locator.
            </li>
            <li>
                UTC: coordinated universal time (also known as Greenwich Mean
                Time, Western European Time).
            </li>
        </ul>
        <p class="info">
            Notes:
        </p>
        <ul class="info">
            <li>
                This CRATE report for researchers was generated by scanning a
                research database and summarizing key features (including by
                reference to a CRATE data dictionary). CRATE version:
                {{ CRATE_VERSION }}.
            </li>
            <li>
                The number of distinct values is taken from SELECT
                COUNT(DISTINCT some_column), which does not include NULL
                values. The actual distinct values, if shown, are taken from
                SELECT DISTINCT some_column, which does include NULL values.
            </li>
        </ul>

        {{ tables_html|safe }}

    </body>
</html>
